<!DOCTYPE html>
<html>
<head>
<meta charset="UTF-8">

<!-- ðŸ”¥ Deaktiver cache -->
<meta http-equiv="Cache-Control" content="no-cache, no-store, must-revalidate" />
<meta http-equiv="Pragma" content="no-cache" />
<meta http-equiv="Expires" content="0" />

<style>
html, body {
  margin: 0;
  padding: 0;
  height: 100%;
  overflow: hidden;
}
#niraviewer {
  width: 100%;
  height: 100%;
  border: 0;
}
</style>

<script src="https://sdk.nira.app/js/viewer.js"></script>
</head>

<body>

<iframe
  id="niraviewer"
  src="https://nidaros.nira.app/g/y-93qFDYS2W-8ACrlqVj8A">
</iframe>

<script>

let viewer = new NiraAPI.Viewer(
  document.getElementById("niraviewer"),
  {
    showNavigationTools: true,
    showMeasureTool: true,
    showCalloutsList: true,
    showRenderModes: true,
    suppressCalloutDialog: false
  }
);

// ðŸ”¥ NÃ¥r asset er ferdig lastet
viewer.on("callout_activated", function (info, event) {

  if (event && event.preventDefault) {
      event.preventDefault();
  }

  viewer.setSessionState({
      activeTool: null,
      showCalloutDialog: false
  });

  if (window.FileMaker && FileMaker.PerformScript) {
      FileMaker.PerformScript("Test_From_nira", info);
  }

  return false;
});




// ðŸ”¥ UUID tilbake til FileMaker (Pro + WebDirect)
viewer.on("callout_activated", function (info) {

  try {

    // FileMaker Pro
    if (window.FileMaker && FileMaker.PerformScript) {
      FileMaker.PerformScript("Test_From_nira", info.uuid);
      return;
    }

    // WebDirect (PerformScriptWithOption)
    if (window.FileMaker && FileMaker.PerformScriptWithOption) {
      FileMaker.PerformScriptWithOption("Test_From_nira", info.uuid, 0);
      return;
    }

    // WebDirect nested iframe fallback
    if (window.parent && window.parent.FileMaker) {
      window.parent.FileMaker.PerformScriptWithOption("Test_From_nira", info.uuid, 0);
      return;
    }

  } catch (e) {
    console.log("Bridge error:", e);
  }

});

// ðŸ”µ Velg / navigasjon
function activateSelectMode() {

  viewer.setSessionState({
    activeTool: null
  });

}

// ðŸŸ¢ Ny markering
function activateCalloutMode() {

  viewer.setSessionState({
    activeTool: "Callout"
  });

}




</script>

</body>
</html>















