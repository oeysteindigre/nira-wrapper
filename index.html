<!DOCTYPE html>
<html>
<head>
<meta charset="UTF-8">

<!-- ðŸ”¥ Deaktiver cache -->
<meta http-equiv="Cache-Control" content="no-cache, no-store, must-revalidate" />
<meta http-equiv="Pragma" content="no-cache" />
<meta http-equiv="Expires" content="0" />

<style>
html, body {
  margin:0;
  padding:0;
  height:100%;
  overflow:hidden;
}
iframe {
  width:100%;
  height:100%;
  border:0;
}
</style>

<script src="https://sdk.nira.app/js/viewer.js"></script>
</head>

<body>

<iframe
  id="niraviewer"
  src="https://nidaros.nira.app/g/y-93qFDYS2W-8ACrlqVj8A">
</iframe>

<script>

let viewer;

viewer = new NiraAPI.Viewer(
  document.getElementById("niraviewer"),
  {
    showNavigationTools: false,
    showMeasureTool: false,
    showCalloutsList: false,
    showRenderModes: false,
    suppressCalloutDialog: true   // MÃ¥ vÃ¦re her ogsÃ¥
  }
);

viewer.on("asset_load_finish", function() {

  // MÃ¥ settes ETTER load
  viewer.setSessionState({
    calloutTransitionStyle: "None",
    calloutViewStyle: "CalloutId"
  });

  // MÃ¥ settes ETTER session state
  viewer.setViewOptions({
    suppressCalloutDialog: true
  });

});

viewer.on("callout_activated", function(info) {

  // FileMaker Pro
  if (window.FileMaker && FileMaker.PerformScript) {
    FileMaker.PerformScript("Test_From_nira", info.uuid);
  }

  // WebDirect (ett nivÃ¥ opp)
  else if (window.parent && window.parent.FileMaker) {
    window.parent.FileMaker.PerformScript("Test_From_nira", info.uuid);
  }

  // WebDirect (to nivÃ¥ opp â€“ fallback)
  else if (window.parent && window.parent.parent && window.parent.parent.FileMaker) {
    window.parent.parent.FileMaker.PerformScript("Test_From_nira", info.uuid);
  }

});


// ðŸ”¥ Send UUID til FileMaker
viewer.on("callout_activated", function(info) {

  // FileMaker Pro
  if (window.FileMaker && FileMaker.PerformScript) {
    FileMaker.PerformScript("Test_From_nira", info.uuid);
  }

  // WebDirect
  else if (window.parent && window.parent.FileMaker) {
    window.parent.FileMaker.PerformScript("Test_From_nira", info.uuid);
  }

});

// ðŸ”¥ Tool-styring fra FileMaker
function setTool(toolName) {

  viewer.setSessionState({
    navigationMode: toolName
  });

}

</script>

</body>
</html>


